/**
 * Created by Администратор on 05.07.2014.
 */

module.exports = function(parameterMap){
    this.taksistToken = parameterMap.token;
    this.issueId = parameterMap.issueId;
    this.cost = parameterMap.cost;
    this.doAction = function(){
        var taksistHandler = require('userHandler').taksistHandler;
        var taksist = taksistHandler.getUserByToken(this.taksistToken);
        taksist.saveCoordinate();
        var actionHandler = require('actionHandler');
        var issue = require('issueHandler').getIssueById(this.issueId);
        var taksistAnswer = issue.addTaksistCost(taksist, this.cost);
        var client = issue.getClient();
        if (client){
            actionHandler.serverActionHandler.doAction({
                action:actionHandler.serverActionsValues.sendTaksistsDataWithCostToClient,
                client: client,
                taksistAnswers: [taksistAnswer]
            });
        }
    }
};